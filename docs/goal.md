# 水泳競技選手向け 目標進捗管理機能 要件定義（ドラフト）

## 1. 目的

競技水泳選手が

* 大会目標（タイム）を起点に
* 日々の練習と結びつけながら
* 自己成長を可視化し、モチベーションを維持する

ための **目標・進捗管理機能** を提供する。

※ 本機能は **選手個人利用を前提** とし、他者（コーチ・チームメイト）からのフィードバック機能は含まない。

---

## 2. 想定ユーザー

* 競技水泳選手

  * 高校生・大学生・社会人競技者
* 自己管理能力があり、数値ベースで成長を確認したい層

---

## 3. 機能全体像

```
大会目標（ゴール）
 └ マイルストーン（練習・中間目標）
     └ 練習記録 / 大会記録（自動連携）
```

---

## 4. 目標設計

### 4.1 大会目標（必須）

**目的**

* 最終ゴールとしての明確なタイム目標を設定する

**仕様**

* 種類：タイム目標のみ
* 設定可能項目

  * 大会名
  * 種目（例：100m Freestyle）
  * 目標タイム
  * 大会日
  * 初期タイム（基準記録）
  
  ※大会名、大会日はConpetitionテーブルのやつと紐づくイメージ。

---

### 4.2 マイルストーン

**目的**

* 大会目標を達成するための中間目標
* 練習と大会を論理的につなぐ

**作成者**

* 選手本人
* テンプレートを利用可能

**作成タイミング**

* 大会目標作成時
* または後から追加

---

## 5. マイルストーンの種類

### 5.1 タイム目標

* 例：

  * 50m × 1本：26.0秒
  * 100m × 1本：53.5秒

---

### 5.2 本数 × タイム目標

* 例：

  * 50m × 10本 @30.0 平均
  * 100m × 5本 × 3セット @1:05 平均

---

### 5.3 セット完遂型

* 例：

  * 200m × 4本× 3セット （@2:20サークル）完遂

---

## 6. マイルストーンテンプレート

**目的**

* 思考コストを下げ、設定のハードルを下げる

**仕様**

* 種目別・目的別テンプレート

  * 例：

    * 100m Fr 短距離対策
    * 後半型レース対策
* テンプレ適用後

  * 数値のみ編集可能
  * 期限は自動提案（例：1ヶ月後）

---

## 7. 練習メニューとの結合

### 7.1 milestone タグ,練習との紐付け

* マイルストーン作成時に自動生成
* 形式：`milestone:{milestone_id}`
* 練習ログ作成フォームで、「milestoneから練習を作成」みたいなボタンを押すと、自動でそのメニュー（距離、本数、セット数、サークル）が入力され、タグが自動でつくようになる

---

## 8. 自動達成判定

### 8.1 判定対象

* 練習記録
* 大会記録

※ 手動入力は不要

---

### 8.2 大会目標の達成率（差分ベース）

```
達成率 = (初期タイム − 最新ベスト) / (初期タイム − 目標タイム)
```

* 表示範囲：0〜100%
* 目標達成後は100%固定

---

### 8.3 マイルストーン達成率（個数ベース）

```
達成率 = 達成済みマイルストーン数 / 全マイルストーン数
```

---

### 8.4 マイルストーン状態

* 未挑戦
* 進行中
* 達成
* 期限切れ

---

## 9. 未達成・失敗時の扱い

### 9.1 期限内

* 未達成でも否定的表現は行わない
* 表示内容

  * 目標との差分（数値）

例：

* 目標：50m @29.5
* 実績：30.2
* 差分：+0.7

---

### 9.2 期限超過時（自己内省モーダル）

**表示条件**

* マイルストーン期限超過時に1回のみ表示

**内容**

* マイルストーン概要
* 試行回数
* ベスト記録
* 目標との差分

**内省項目（選択式）**

* 目標が高すぎた
* 期間が短かった
* 練習量が足りなかった
* コンディション不良
* その他（自由記述）

---

### 9.3 次のアクション誘導

* 数値を調整して再挑戦
* 次のマイルストーンへ進む
* 新しいマイルストーンを作成

---

## 10. モチベーション設計方針

### 10.1 行わないこと

* 他者比較
* 失敗回数の強調
* 強い否定色・警告表現

---

### 10.2 行うこと

* 過去の自分との比較
* 数値による事実提示
* 達成時のみ強い演出

---

## 11. データモデル（現状のテーブルの中身見てないので適当に作った）

```ts
Goal {
  id
  user_id
  type: 'competition'
  event
  distance
  target_time
  start_time
  competition_date
}

Milestone {
  id
  goal_id
  type: 'time' | 'reps_time' | 'set' | 'distance'
  params: JSON
  deadline
  status
}
```

---

## 12. 今後の検討事項

* マイルストーン達成判定条件（1回 or 複数回）
* 複数大会目標の同時管理
* UI構成・画面遷移設計

---

※ 本ドキュメントは初期要件定義（ドラフト）であり、今後の壁打ちにより更新される。
